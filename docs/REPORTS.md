# Test Reports

This document describes how to view and work with test reports generated by Playwright and other testing tools.

## Playwright Reports

### Running Tests

```bash
# Run E2E tests (generates static HTML report)
npm run -w web test:e2e

# Run tests and automatically open report
npm run -w web test:e2e:report
```

### Viewing Reports

#### Option 1: Open as File (Recommended)

Opens the report directly as a file URL - no server needed:

```bash
npm run reports:open
```

This is the fastest option and works well for most browsers.

#### Option 2: Serve with Auto-Close

Serves the report on a local server and automatically closes after a timeout:

```bash
# Serve on default port 9323, auto-close after 20 seconds
npm run reports:serve

# Custom options
npm run reports:serve -- --port 8080 --timeout 30000 --no-open
```

**Available options:**

- `--port <number>`: Port to serve on (default: 9323)
- `--timeout <number>`: Auto-close timeout in milliseconds (default: 20000)
- `--no-open`: Don't automatically open browser
- `--open`: Automatically open browser (default)
- `--dir <path>`: Custom report directory

#### Option 3: CI Mode

For CI environments - validates report exists without opening browser:

```bash
npm run reports:ci
```

## Report Locations

- **Playwright HTML Report**: `web/playwright-report/index.html`
- **Test Results**: `web/test-results/`
- **Traces**: `web/test-results/` (on failure)

## CI Artifacts

In CI environments, reports are automatically uploaded as artifacts:

- **Playwright Report**: Available as `playwright-report` artifact
- **Test Results**: Available as `test-results` artifact
- **Traces**: Available as `playwright-traces` artifact

## Troubleshooting

### Report Not Found

If you see "Report not found", run the tests first:

```bash
npm run -w web test:e2e
```

### Browser Blocks File Access

Some browsers block local file access for security. Use the serve option instead:

```bash
npm run reports:serve
```

### Port Already in Use

The serve script automatically finds an available port. If you need a specific port:

```bash
npm run reports:serve -- --port 8080
```

## Static Assets Protection

The i18n middleware is configured to exclude static assets from locale routing:

- `/favicon.ico`
- `/manifest.webmanifest`
- `/icons/*`
- `/robots.txt`
- `/sitemap.xml`
- `/_next/*`
- `/workbox-*.js`

This ensures that icon files and PWA assets are served directly without locale processing.
